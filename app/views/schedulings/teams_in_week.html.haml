- title filter.caption, false

%table#calendar.calendar.teams-in-week{class: filter.range, data: filter.table_metadata}
  %thead
    %tr
      %th
        = render 'week_switch', filter: filter
      - filter.formatted_days.each do |full, date, abbr|
        %th
          = abbr_tag(abbr, full, class: 'day_name')
          %div.date-without-year= date
  %tbody
    - filter.teams.each do |team|
      %tr{data: { team_id: team.id }}
        %th.team
          .pibble.team-color{style: "background-color: #{team.color};"}
          .team_name= team.name
        - filter.days.each do |day|
          - cell_html_options = { data: filter.cell_metadata(day, team) }
          - if filter.outside_plan_period?(day)
            - cell_html_options.merge!(class: 'outside_plan_period')
          %td{cell_html_options}
            = filter.cell_content(day, team)

= render 'plans/details', plan: filter.plan
